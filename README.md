# kyoyoZemi2025

ダイナミクセルMx28を動かすためのサンプルプログラムです．
Windowsで動かすことを想定しています．

## 事前準備
以下の2つのソフトウェアを入れてください．

### ダイナミクセルウィザード
こちらのサイトに従って，ダイナミクセルウィザードをインストールしてください．
このソフトを使えば，ダイナミクセルを簡単に動かすことができます．
https://emanual.robotis.com/docs/en/software/dynamixel/dynamixel_wizard2/

ソフトウェアの使い方などは，日本語だと以下のサイトがまとまっています．
https://www.besttechnology.co.jp/modules/knowledge/?DYNAMIXEL%20basic%20tutorial#q270593c

使い方は最小限は授業中に教えますので，インストールまでできればOKです．

### C++プログラミング環境

C++言語のプログラムを作成・実行できる環境を作ってください．やり方は問いません．
このページでは，VS Code＋GCC with MinGWというやり方を紹介します．

以下の，マイクロソフトの公式サイトの案内に従ってVSCODEとMinGWをインストールしてください．
https://code.visualstudio.com/docs/cpp/config-mingw
（Prerequisites，Installing the MinGW-w64 toolchain，Check your MinGW installation　の3つの節をやってください）


## ダイナミクセルを動かすためのハードウェアの準備

ＵＳＢダイナミクセルをＰＣに接続してください
そして，ダイナミクセルに電源を与えてください．


## プログラムの実行
### 実行前の確認作業
ダイナミクセルと通信するポートが何番かを確かめます．
図のように，windows下部にある検索枠に，`devmng` と打ち込みます．すると，「デバイスマネージャー」が見つかりますので，それをクリックしてデバイスマネージャを立ち上げてください．


[!NOTE]
デバイスマネージャは，PCに接続されているデバイスを管理するマネージャです．USB接続の機器など接続すればここに出てきますので，ＰＣにデバイスを挿しても認識しない場合などはこれを確認すると良いです．


さて，デバイスマネージャを立ち上げると以下のような画面が出てきます．
下にスクロールしていって，「ポート（COMとLPT）」を探して，左側の「＞」印を押して内部の階層が見えるようにしてください．
「USBSerialPort（COM？）」というのが出てくると思います．このCOM番号を覚えておいてください．図の場合はCOM5です．
（複数ポートが出てくるときは，USBダイナミクセルを抜いて消えるポートを確認するなどして，どれがUSBダイナミクセルに対応しているかを特定してください．）

[!NOTE]
ダイナミクセルとＰＣの通信はシリアル通信と呼ばれる規格を使っています．
この通信のポート番号（出入り口番号）がＰＣ内部で割り振られるので，ダイナミクセルと通信する際は，このポート番号を指定して通信してやる必要があります．




### 実行前の準備
ここに上がっているプログラム一式を任意のフォルダ内に保存．
写真の例では，SampleDyna　というフォルダ内部にファイルを置いています．

次に，プログラムファイル上で，通信ポートやダイナミクセルＩＤなどを変更します．

main_test_commSpeed.cppを開きます．ダブルクリックすると，VisualStudioCodeで開けると思います．
ファイルを開いたら，以下の図の場所を修正します．

- １４行目の，`"\\\\.\\COM?"` の部分を，確認した通信ポートの番号に変更します． 例　`"\\\\.\\COM3"`
- ２５行目の　`int ID = ?` の部分で，？に，ダイナミクセルのＩＤ番号を入れてください（シールを張ってます）．　例　`int ID =  12`

同様に，main_test_ctrLoop.cppを開きます．ダブルクリックすると，VisualStudioCodeで開けると思います．
ファイルを開いたら，以下の図の場所を修正します．

- １４行目の，`"\\\\.\\COM?"` の部分を，確認した通信ポートの番号に変更します． 例　`"\\\\.\\COM3"`
- ２５行目の　`int ID = ?` の部分で，？に，ダイナミクセルのＩＤ番号を入れてください（シールを張ってます）．　例　`int ID =  12`

### 通信のテストプログラムのコンパイルと実行
ターミナルにてプログラムファイルと同じ階層にて，以下のコマンドを売ってください．
```bash
g++ -o testComm.exe  main_test_commSpeed.cpp  serial.cpp  amBasic.cpp  -lstdc++
```

### 制御サンプルプログラムのコンパイルと実行
ターミナルにてプログラムファイルと同じ階層にて，以下のコマンドを売ってください．
```bash
g++ -o testComm.exe  main_test_ctrLoop.cpp  serial.cpp  amBasic.cpp  -lstdc++
```


